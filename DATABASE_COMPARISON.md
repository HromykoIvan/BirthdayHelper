# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ MongoDB vs DynamoDB –¥–ª—è BirthdayBot

## –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—É—â–Ω–æ—Å—Ç–∏
1. **User** (~1-10K –∑–∞–ø–∏—Å–µ–π)
   - –ü–æ–∏—Å–∫ –ø–æ `TelegramUserId` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
   - –ü—Ä–æ—Å—Ç—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (timezone, language, tone)

2. **Birthday** (~10-100K –∑–∞–ø–∏—Å–µ–π)
   - –ü–æ–∏—Å–∫ –ø–æ `UserId` (partition key)
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `Month` –∏ `Day` (–≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è)
   - –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ (case-insensitive)
   - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏

3. **DeliveryLog** (~100K-1M –∑–∞–ø–∏—Å–µ–π, —Ä–∞—Å—Ç–µ—Ç —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º)
   - –ü–æ–∏—Å–∫ –ø–æ `UserId`
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `WhenUtc` (descending)
   - –¢–æ–ª—å–∫–æ append (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ç–æ—á–µ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –∫–ª—é—á–∞–º
- ‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞)
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—ã—á–∏—Å–ª—è–µ–º—ã–º –ø–æ–ª—è–º
- ‚úÖ Case-insensitive –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: MongoDB vs DynamoDB

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ DynamoDB

1. **–ù–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AWS**
   - IAM —Ä–æ–ª–∏ –≤–º–µ—Å—Ç–æ connection strings
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CloudWatch, X-Ray
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier: 25 GB storage, 25 RCU/WCU

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
   - –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ <10ms (single-digit)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è multi-region

3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
   - Fully managed (–Ω–µ—Ç EC2 –∏–Ω—Å—Ç–∞–Ω—Å–∞ –¥–ª—è MongoDB)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã (Point-in-Time Recovery)
   - –ú–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç

4. **–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–ª—è –º–∞–ª–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞**
   - On-demand pricing: –ø–ª–∞—Ç–∏—à—å —Ç–æ–ª—å–∫–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
   - –ù–µ—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ EC2 –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è MongoDB
   - –ü—Ä–∏–º–µ—Ä–Ω–æ $0.25/GB storage, $1.25/million reads

### ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ DynamoDB

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**
   - ‚ùå –ù–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—ã—á–∏—Å–ª—è–µ–º—ã–º –ø–æ–ª—è–º (`Month`, `Day`)
   - ‚ùå Case-insensitive –ø–æ–∏—Å–∫ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏
   - ‚ùå –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ—Ä–æ–≥–æ–µ (Scan operation)
   - ‚ùå –ù–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è

2. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è**
   - –ù—É–∂–Ω–æ –ø—Ä–æ–¥—É–º–∞—Ç—å partition key –∏ sort key
   - GSI (Global Secondary Index) –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

3. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**
   - DynamoDB Local —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –ú–µ–Ω—å—à–µ —É–¥–æ–±—Å—Ç–≤–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - –ù–µ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ GUI (–∫–∞–∫ MongoDB Compass)

4. **–ú–∏–≥—Ä–∞—Ü–∏—è**
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
   - –ò–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (—É–±—Ä–∞—Ç—å ObjectId)
   - –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ–¥ DynamoDB API

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–°–¢–ê–í–ò–¢–¨ MongoDB** (–¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)

**–ü—Ä–∏—á–∏–Ω—ã:**

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `Month`/`Day` —Ä–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"
   - Case-insensitive –ø–æ–∏—Å–∫ –ø—Ä–æ—Å—Ç–æ–π
   - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–µ—à–µ–≤–æ–µ

2. **–£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –í—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
   - –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
   - Docker Compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

3. **–ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–µ–∫—Ç–∞**
   - –î–ª—è Telegram –±–æ—Ç–∞ —Å —Ç—ã—Å—è—á–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π MongoDB –Ω–∞ EC2 –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
   - –°—Ç–æ–∏–º–æ—Å—Ç—å EC2 t4g.micro (free tier) + EBS = $0-10/–º–µ—Å—è—Ü
   - DynamoDB –¥–ª—è —Ç–∞–∫–æ–≥–æ –æ–±—ä–µ–º–∞ –±—É–¥–µ—Ç –¥–æ—Ä–æ–∂–µ

4. **–ì–∏–±–∫–æ—Å—Ç—å**
   - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –∏ –∏–Ω–¥–µ–∫—Å—ã
   - –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π DynamoDB

### üîÑ **–ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ DynamoDB:**

1. **–ú–∞—Å—à—Ç–∞–±:**
   - >100K –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - >1M –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è
   - –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (—Ç—ã—Å—è—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫)

2. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
   - –ù—É–∂–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
   - –ö—Ä–∏—Ç–∏—á–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ (<10ms)
   - –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ AWS —Å–µ—Ä–≤–∏—Å–∞–º–∏

3. **–ë—é–¥–∂–µ—Ç:**
   - –ì–æ—Ç–æ–≤—ã –ø–ª–∞—Ç–∏—Ç—å –∑–∞ managed —Å–µ—Ä–≤–∏—Å
   - –ù—É–∂–Ω–æ —É–±—Ä–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ MongoDB

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: MongoDB –≤ Docker (—Ç–µ–∫—É—â–∏–π) ‚úÖ
```yaml
# docker-compose.yaml
mongodb:
  image: mongo:6.0
  ports:
    - "27017:27017"
```
**–ü–ª—é—Å—ã:** –ü—Ä–æ—Å—Ç–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ, –µ—Å—Ç—å GUI (Compass)

### –í–∞—Ä–∏–∞–Ω—Ç 2: MongoDB Atlas (Free Tier)
- 512 MB storage –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ –Ω—É–∂–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π MongoDB

### –í–∞—Ä–∏–∞–Ω—Ç 3: DynamoDB Local (–µ—Å–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ DynamoDB)
```bash
docker run -p 8000:8000 amazon/dynamodb-local
```
**–ú–∏–Ω—É—Å—ã:** –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞, –Ω–µ—Ç GUI

### –í–∞—Ä–∏–∞–Ω—Ç 4: LocalStack (–¥–ª—è –ø–æ–ª–Ω–æ–π AWS —ç–º—É–ª—è—Ü–∏–∏)
```yaml
localstack:
  image: localstack/localstack
  environment:
    - SERVICES=dynamodb
```
**–ü–ª—é—Å—ã:** –≠–º—É–ª–∏—Ä—É–µ—Ç AWS —Å–µ—Ä–≤–∏—Å—ã –ª–æ–∫–∞–ª—å–Ω–æ

---

## –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–µ—Å–ª–∏ –≤—Å–µ –∂–µ –Ω—É–∂–µ–Ω DynamoDB)

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Repository Pattern** –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±–µ–∏—Ö –ë–î:

```csharp
// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ
public interface IBirthdayRepository { ... }

// –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏
public class MongoBirthdayRepository : IBirthdayRepository { ... }
public class DynamoBirthdayRepository : IBirthdayRepository { ... }

// –í DI
if (useDynamoDb) {
    services.AddSingleton<IBirthdayRepository, DynamoBirthdayRepository>();
} else {
    services.AddSingleton<IBirthdayRepository, MongoBirthdayRepository>();
}
```

**–ù–æ:** –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∫–æ–¥ –∏ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–≤—É—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π.

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | MongoDB (—Ç–µ–∫—É—â–∏–π) | DynamoDB |
|----------|-------------------|----------|
| **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞** | ‚úÖ –ü—Ä–æ—Å—Ç–æ (Docker) | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| **–°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** | ‚úÖ –ì–∏–±–∫–æ | ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ |
| **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** | ‚úÖ –õ—é–±—ã–µ –ø–æ–ª—è | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –ø–æ sort key |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å (–º–∞–ª—ã–π –º–∞—Å—à—Ç–∞–±)** | ‚úÖ $0-10/–º–µ—Å (EC2) | ‚ö†Ô∏è $5-20/–º–µ—Å |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** | ‚ö†Ô∏è –ù—É–∂–µ–Ω EC2 | ‚úÖ Fully managed |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚úÖ –•–æ—Ä–æ—à–æ | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚ö†Ô∏è –†—É—á–Ω–æ–µ | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ |
| **AWS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | ‚ö†Ô∏è –ß–µ—Ä–µ–∑ EC2 | ‚úÖ –ù–∞—Ç–∏–≤–Ω–∞—è |

---

## –í—ã–≤–æ–¥

**–î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞: –æ—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –Ω–∞ MongoDB**

- –ü—Ä–æ–µ–∫—Ç —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ó–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Å—Ç—ã–µ –∏ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è MongoDB
- –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —É–¥–æ–±–Ω–∞—è
- –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞

**–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ DynamoDB, –µ—Å–ª–∏:**
- –ü—Ä–æ–µ–∫—Ç –≤—ã—Ä–∞—Å—Ç–µ—Ç –¥–æ >100K –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ù—É–∂–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
- –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ì–æ—Ç–æ–≤—ã –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–æ–¥ –ø–æ–¥ DynamoDB –º–æ–¥–µ–ª—å

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- –¢–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥ (MongoDB –≤ Docker) –æ–ø—Ç–∏–º–∞–ª–µ–Ω
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å MongoDB Atlas –¥–ª—è shared dev environment

