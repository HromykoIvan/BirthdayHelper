# –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman —Å Mock Telegram Client

## üéØ –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç

–í–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É–Ω–Ω–µ–ª—è –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∫ Telegram API, –≤—ã –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é –ª–æ–≥–∏–∫—É –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Postman. –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ç "–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç", —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API endpoint.

---

## ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ Mock Client

–í `appsettings.Development.json` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ:
```json
{
  "Bot": {
    "WebhookSecret": "35309489b499f510d3c7e7034fef56ac04cb5d9d0288e053",
    "UseMockClient": true
  }
}
```

**–í–∞–∂–Ω–æ:** `UseMockClient: true` –≤–∫–ª—é—á–∞–µ—Ç mock-—Ä–µ–∂–∏–º.

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ API

```powershell
cd backend/src/BirthdayBot.Api
dotnet run
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```powershell
.\scripts\local-dev.ps1
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Mock –∞–∫—Ç–∏–≤–µ–Ω

–í –ª–æ–≥–∞—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
[MOCK] SetMyCommandsAsync: Commands=6
```

---

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman

### 1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ webhook –∑–∞–ø—Ä–æ—Å

**Method:** `POST`  
**URL:** `http://localhost:8080/telegram/webhook`

**Headers:**
```
Content-Type: application/json
X-Telegram-Bot-Api-Secret-Token: 35309489b499f510d3c7e7034fef56ac04cb5d9d0288e053
```

**Body (JSON):**
```json
{
  "update_id": 123456789,
  "message": {
    "message_id": 1,
    "from": {
      "id": 123456789,
      "is_bot": false,
      "first_name": "Test",
      "username": "testuser"
    },
    "chat": {
      "id": 123456789,
      "type": "private"
    },
    "date": 1704288000,
    "text": "/start"
  }
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** `200 OK`

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**Method:** `GET`  
**URL:** `http://localhost:8080/api/mock/messages`

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "count": 1,
  "messages": [
    {
      "chatId": 123456789,
      "text": "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è...",
      "parseMode": null,
      "replyToMessageId": null,
      "replyMarkup": null,
      "timestamp": "2026-01-03T14:30:00Z"
    }
  ]
}
```

### 3. –ü–æ–ª—É—á–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞

**Method:** `GET`  
**URL:** `http://localhost:8080/api/mock/messages/123456789`

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "chatId": 123456789,
  "count": 1,
  "messages": [
    {
      "text": "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –¥–Ω—è—Ö —Ä–æ–∂–¥–µ–Ω–∏—è...",
      "timestamp": "2026-01-03T14:30:00Z"
    }
  ]
}
```

### 4. –û—á–∏—Å—Ç–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**Method:** `DELETE`  
**URL:** `http://localhost:8080/api/mock/messages`

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "message": "Messages cleared"
}
```

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö–æ–º–∞–Ω–¥–∞ /start

**Request:**
```json
{
  "update_id": 1,
  "message": {
    "message_id": 1,
    "from": {
      "id": 123456789,
      "is_bot": false,
      "first_name": "Test"
    },
    "chat": {
      "id": 123456789,
      "type": "private"
    },
    "date": 1704288000,
    "text": "/start"
  }
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å ‚Üí `200 OK`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/api/mock/messages/123456789`
3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è

**Request 1 - /add_birthday:**
```json
{
  "update_id": 2,
  "message": {
    "message_id": 2,
    "from": { "id": 123456789, "is_bot": false, "first_name": "Test" },
    "chat": { "id": 123456789, "type": "private" },
    "date": 1704288000,
    "text": "/add_birthday"
  }
}
```

**Request 2 - –ò–º—è:**
```json
{
  "update_id": 3,
  "message": {
    "message_id": 3,
    "from": { "id": 123456789, "is_bot": false, "first_name": "Test" },
    "chat": { "id": 123456789, "type": "private" },
    "date": 1704288001,
    "text": "–ò–≤–∞–Ω"
  }
}
```

**Request 3 - –î–∞—Ç–∞:**
```json
{
  "update_id": 4,
  "message": {
    "message_id": 4,
    "from": { "id": 123456789, "is_bot": false, "first_name": "Test" },
    "chat": { "id": 123456789, "type": "private" },
    "date": 1704288002,
    "text": "1990-05-15"
  }
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤—Å–µ —Ç—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/api/mock/messages/123456789`
3. –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–ø–∏—Å–æ–∫ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è

**Request:**
```json
{
  "update_id": 5,
  "message": {
    "message_id": 5,
    "from": { "id": 123456789, "is_bot": false, "first_name": "Test" },
    "chat": { "id": 123456789, "type": "private" },
    "date": 1704288003,
    "text": "/list"
  }
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø–∏—Å–æ–∫ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è

---

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ API Endpoints

### 1. Webhook (–æ—Å–Ω–æ–≤–Ω–æ–π)
- **POST** `/telegram/webhook` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç Telegram updates

### 2. Mock Messages (—Ç–æ–ª—å–∫–æ –≤ Development)
- **GET** `/api/mock/messages` ‚Äî –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **GET** `/api/mock/messages/{chatId}` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
- **DELETE** `/api/mock/messages` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### 3. Health Checks
- **GET** `/healthz` ‚Äî –ø—Ä–æ—Å—Ç–æ–π health check
- **GET** `/health/ready` ‚Äî readiness —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π MongoDB

---

## üîç –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

1. **Webhook –∑–∞–ø—Ä–æ—Å –ø—Ä–∏—Ö–æ–¥–∏—Ç** ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω–æ
2. **–ë–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ** ‚Üí –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ API –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è Mock
3. **Mock —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ** –≤ –ø–∞–º—è—Ç–∏ –∏ –ª–æ–≥–∏—Ä—É–µ—Ç
4. **–í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å** –≤—Å–µ "–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ" —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ API

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. ‚úÖ **–ù–µ –Ω—É–∂–µ–Ω —Ç—É–Ω–Ω–µ–ª—å** ‚Äî —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ
2. ‚úÖ **–ù–µ –Ω—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π Telegram** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±—ã–µ Chat ID
3. ‚úÖ **–ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ API
4. ‚úÖ **–ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π** ‚Äî —á–µ—Ä–µ–∑ API endpoint
5. ‚úÖ **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏** ‚Äî –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. ‚ö†Ô∏è **–¢–æ–ª—å–∫–æ –≤ Development** ‚Äî mock —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ `UseMockClient: true`
2. ‚ö†Ô∏è **–°–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏** ‚Äî –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ API —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è
3. ‚ö†Ô∏è **–ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** ‚Äî –≤—ã –Ω–µ –ø–æ–ª—É—á–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram

---

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Mock –∏ Real

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mock (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):
```json
{
  "Bot": {
    "UseMockClient": true
  }
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Real Client (–¥–ª—è production):
```json
{
  "Bot": {
    "UseMockClient": false
  }
}
```

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç–µ `UseMockClient` ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç.

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è Postman Collection

### –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

**Environment Variables:**
- `base_url`: `http://localhost:8080`
- `webhook_secret`: `35309489b499f510d3c7e7034fef56ac04cb5d9d0288e053`
- `test_chat_id`: `123456789`

### –ó–∞–ø—Ä–æ—Å—ã:

1. **Webhook - /start**
   - Method: `POST`
   - URL: `{{base_url}}/telegram/webhook`
   - Headers: `X-Telegram-Bot-Api-Secret-Token: {{webhook_secret}}`
   - Body: JSON —Å `/start` –∫–æ–º–∞–Ω–¥–æ–π

2. **Get Mock Messages**
   - Method: `GET`
   - URL: `{{base_url}}/api/mock/messages/{{test_chat_id}}`

3. **Clear Messages**
   - Method: `DELETE`
   - URL: `{{base_url}}/api/mock/messages`

---

## üéØ Workflow –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ API** —Å `UseMockClient: true`
2. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ webhook –∑–∞–ø—Ä–æ—Å** —á–µ—Ä–µ–∑ Postman
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç—ã** —á–µ—Ä–µ–∑ `/api/mock/messages`
4. **–û—á–∏—Å—Ç–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Ç–µ—Å—Ç–æ–º
5. **–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω Chat ID** –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ ‚Äî —Ç–∞–∫ –ø—Ä–æ—â–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å
2. **–û—á–∏—â–∞–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ API** –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ Postman –∫–æ–ª–ª–µ–∫—Ü–∏—é** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Mock –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `appsettings.Development.json` ‚Äî –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `UseMockClient: true`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `ASPNETCORE_ENVIRONMENT=Development`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É–ª `200 OK`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Chat ID

### –ü—Ä–æ–±–ª–µ–º–∞: Endpoint `/api/mock/messages` –Ω–µ –Ω–∞–π–¥–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `ASPNETCORE_ENVIRONMENT=Development`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ endpoint –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `Program.cs`

